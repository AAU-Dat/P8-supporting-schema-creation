\subsection{Soundness}\label{subsec:soundness}

In the following proofs we allow ourselves to substitute terms $s \into \lookupcl(v)$ with $s$, the justification is that $s \into \lookupcl(v)$ will only ever overestimate $s$, that is $s \sqsubseteq s \into \lookupcl(v)$.

\begin{lemma}\label{thm:sound-skip}
    $\abssem{\texttt{skip}}$ is sound.
\end{lemma}

\begin{proof}
    \pf\ Assume $\rho \in \concrete_1(\ab{P})$, then $\sem{\texttt{skip}}(\rho) = \rho$ and $\abssem{\texttt{skip}}(\ab{P}) = \ab{P}$ and therefore $\sem{\texttt{skip}}(\rho) \in \concrete_1(\abssem{\texttt{skip}}(\ab{P}))$.
\end{proof}

\begin{lemma}\label{thm:sound-assign}
    $\abssem{v_a := e}$ is sound for all $v_a \in \mathbb{V}_a$ and $e \in \mathbb{E}$.
\end{lemma}

\begin{proof}
    \pf\
    Assume $(\env{d}, \env{a}) \in \concrete_1(\ab{P})$ then in $\sem{v_a := e}(\env{d}, \env{a})$ $v_a$ is assigned to $\expsem{e}(\env{d}, \env{a})$. Because $\expsem{e}(\env{d}, \env{a}) \in \concrete_{4a}(s) = \concrete_{4a}(\absexpsem{e}(\env{\ab{d}}, \env{\ab{a}}))$ for $(\env{\ab{d}}, \env{\ab{a}}) \in \ab{P}$ where $(\env{d}, \env{a}) \in \concrete_2(\env{\ab{d}}, \env{\ab{a}})$ then $\sem{v_a := e}(\env{d}, \env{a}) \in \concrete_2(\env{\ab{d}}, \env{\ab{a}}[v_a \mapsto s])$, therefore also $\sem{v_a := e}(\env{d}, \env{a})\in \concrete_1(\abssem{v_a := e}(\ab{P}))$.
\end{proof}

\begin{lemma}\label{thm:sound-random}
    $\abssem{v_a := ?}$ is sound for all $v_a \in \mathbb{V}_a$.
\end{lemma}

\begin{proof}
    \pf\
    Assume $(\env{d}, \env{a}) \in \concrete_1(\ab{P})$ then $\sem{v_a := ?}(\env{d}, \env{a})$ non-deterministically maps $(\env{d}, \env{a})$ to $P = \{ (\env{d}, \env{a}[v_a \mapsto s]) | s \in \Gamma(v_a) \}$, where $\Gamma(v_a)$ is the possible singleton values assignable to $v_a$.
    For $(\env{d}, \env{a}) \in \gamma_2(\env{\ab{d}}, \env{\ab{a}})$ where $(\env{\ab{d}}, \env{\ab{a}}) \in \ab{P}$, it should be evident that $\rho \in \gamma_2(\env{\ab{d}}, \env{\ab{a}}[v_a \mapsto \mathsf{Single}\;\top])$ for $\rho \in P$, and therefore $\sem{v_a := ?}(\env{d}, \env{a}) \subseteq \concrete_1(\abssem{v_a := ?}(\ab{P}))$.
\end{proof}

\begin{lemma}\label{thm:sound-bool}
    $\abssem{b}$ is sound for all $b \in \mathbb{B}$.
\end{lemma}

\begin{proof}
    \pf\
    Assume $(\env{d}, \env{a}) \in \concrete_1(\ab{P})$ and $\boolsem{b}(\env{d}, \env{a}) = \true$ then $\sem{b}(\env{d}, \env{a}) = (\env{d}, \env{a})$.
    Because $\boolsem{b}(\env{d}, \env{a}) \in \concrete_{4a}(\absboolsem{b}(\env{\ab{d}}, \env{\ab{a}}))$ for $(\env{d}, \env{a}) \in \concrete_2(\env{\ab{d}}, \env{\ab{a}})$ where $(\env{\ab{d}}, \env{\ab{a}}) \in \ab{P}$ then $(\env{\ab{d}}, \env{\ab{a}})$ must be in $\abssem{b}(\ab{P})$ because $\absboolsem{b}(\env{\ab{d}}, \env{\ab{a}})$ must contain $B$ such that $B$ contains $\true$, because of the initial assumption.
\end{proof}

\begin{lemma}\label{thm:sound-sql}
    $\abssem{C_{sql}}$ is sound for all $C_{sql} \in \mathbb{C}_{sql}$.
\end{lemma}

\begin{proof}
    \pf\
    This follows from the fact that $\abssqlsem{C_{sql}}$ is sound for all $C_{sql}$.
\end{proof}

\begin{theorem}
    $\abssem{I}$ is sound, for all $I \in \mathbb{I}$.
\end{theorem}

\begin{proof}
    \pf\
    This immediately follows from \autoref{thm:sound-skip}, \ref{thm:sound-assign}, \ref{thm:sound-random}, \ref{thm:sound-bool} and \ref{thm:sound-sql}.
\end{proof}

